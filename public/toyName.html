<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Toy Name</title>
    <link rel="stylesheet" href="/css/semantic.min.css">
    <link rel="stylesheet" href="/css/toy.css">
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="/script/semantic.min.js"></script>
    <script language="javascript">
    $(document).ready(function(){

        var toyId = "6";

        $('#AddToCart').click(function() {
            alert($('#cartId').val());
            var cartId = $('#cartId').val();
            var cartDetail = {};
            if(cartId == null || cartId == '') {
                $.ajax({
                    url: '/rest/cart',
                    type: 'put',
                    success: function(data){
                        cartDetail.cartId = data.cartId;
                        $('#cartId').val(data.cartId);
                        cartDetail.toyId = toyId;
                        cartDetail.qty = $('.toyQty option:selected').val();

                        var cartDetailData = JSON.stringify(cartDetail);

                        $.ajax({
                            url: '/rest/cart/detail',
                            type: 'put',
                            data: cartDetailData,
                            contentType: 'application/json; charset=utf-8',
                            success: function(data){
                                alert(data.cartDetailId);
                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                var errorMsg = 'Ajax request failed: ' + xhr.responseText;
                                $('#content').html(errorMsg);
                            }
                        });
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        var errorMsg = 'Ajax request failed: ' + xhr.responseText;
                        $('#content').html(errorMsg);
                    }
                });
            } else {
                cartDetail.cartId = cartId;
                cartDetail.toyId = toyId;
                cartDetail.qty = $('.toyQty option:selected').val();

                var cartDetailData = JSON.stringify(cartDetail);

                $.ajax({
                    url: '/rest/cart/detail',
                    type: 'put',
                    data: cartDetailData,
                    contentType: 'application/json; charset=utf-8',
                    success: function(data){
                        alert(data.cartDetailId);
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        var errorMsg = 'Ajax request failed: ' + xhr.responseText;
                        $('#content').html(errorMsg);
                    }
                });
            }
        });

        $.ajax({
            url: '/rest/toy/' + toyId,
            type: 'get',
            success: function(data){
                $('.toyName').text(data.name);
                $('.toyBrand').text(data.brand);
                $('.toyGender').text(data.gender);
                $('.toyAge').text(data.age);
                $('.toyPrice').text(data.price);
                $('.toyShipping').text(data.shippingMethod);
                $('.toyStock').text(data.stockStatus);
                $('.toyStockQty').text(data.qty);
                $('.toyImg').attr('src', data.toyImg);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                var errorMsg = 'Ajax request failed: ' + xhr.responseText;
                $('#content').html(errorMsg);
            }
        });
    });
    </script>
</head>
<body>
<div class="content">
    <h2><font color="#ffffff">Toy Detail</font></h2>
</div>
<input type="hidden" id="cartId" value="">
<table class="toy">
    <tr>
        <th colspan="3"><h1><div class="toyName"></div></h1></th>
    </tr>
    <tr>
        <td rowspan="8" width="50%" align="center"><img class="toyImg" height="400" width="600"></td>
        <td><h3>Brand</h3></td>
        <td><div class="toyBrand" id="2toyBrand"></div></td>
    </tr>
    <tr>
        <td><h3>Gender</h3></td>
        <td><div class="toyGender" id="2toyGender"></div></td>
    </tr>
    <tr>
        <td><h3>Age</h3></td>
        <td><div class="toyAge" id="2toyAge"></div></td>
    </tr>
    <tr>
        <td><h3>Price</h3></td>
        <td><div class="toyPrice" id="2toyPrice"></div></td>
    </tr>
    <tr>
        <td><h3>Shipping Method</h3></td>
        <td><div class="toyShipping" id="2toyShipping"></div></td>
    </tr>
    <tr>
        <td><h3>Stock Status</h3></td>
        <td><div class="toyStock" id="2toyStock"></div></td>
    </tr>
    <tr>
        <td><h3>Stock Qty</h3></td>
        <td><div class="toyStockQty" id="2toyStockQty"></div></td>
    </tr>
    <tr>
        <td><h3>Quantity</h3></td>
        <td><select name="2toyQty" id="2toyQty" class="toyQty">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td colspan="2"><button class="ui primary button" id="AddToCart">Add to cart</button></td>
    </tr>
</table>
</body>
</html>